import RsOPNA
import time

def mem_init(start, stop, count, msg):
    rs.msg(msg)
    rs.out(0x10, 0x08).out(0x10, 0x80)
    rs.out(0x00, 0x30).out(0x01, 0x02)
    rs.out(0x02, start & 0xff).out(0x03, (start >> 8) & 0xff)
    rs.out(0x04, stop & 0xff).out(0x05, (stop >> 8) & 0xff)
    rs.nl()
    rs.mrd(count).nl()
    rs.out(0x00, 0x00).out(0x10, 0x80).nl()

rs = RsOPNA.RsOPNA()
rs.open()
rs.reset()

rs.seq_mem_limit(0xffff)

pat1 = [
    0xff, 0xff,
    0x43, 0xcb,
    0x43, 0xcb,
    0x43, 0xcb,

    0x43, 0xcb,
    0x43, 0xcb,
    0x43, 0xcb,
    0x43, 0xcb,

    0x43, 0xcb,
    0x43, 0xcb,
    0x43, 0xcb,
    0x43, 0xcb,

    0x43, 0xcb,
    0x43, 0xcb,
    0x43, 0xcb,
    0x43, 0xcb,
]
rs.seq_mem_fill_pat(0x0000, 0x0000, pat1, 32 * 0x01, "FILL 0000-0001 (22,aa)")
#rs.seq_mem_fill_random(0x0000, 0x000f, 32 * 0x10, "FILL 0000-000f (RND)")
#rs.seq_mem_fill(0x0010, 0x001f, 0x80, 32 * 0x10, "FILL 0010-001f (80)")
#rs.seq_play(0x0010, 0x001f, 4719, 0xff, True, "PLAY")
rs.seq_play(0x0000, 0x0000, int(500), 0xff, False, "PLAY")

for j in range (20):
    for i in range(10):
        rs.stat().nl()
        time.sleep(0.5)
    #rs.out(0x10, 0x04).out(0x10, 0x00).nl()

rs.seq_stop("STOP")
