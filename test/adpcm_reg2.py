import RsOPNA
import time

rs = RsOPNA.RsOPNA()
rs.open()
rs.reset()

'''
ADPCM再生中にレジスタ08を読んで観察するテストプログラム
1. 00-FFのデータを書き込む
2. 再生中にレジスタを読み出し値をみる

全体
    値は一定でないので、再生しているデータが取得されていると考える。
    ニブルが入れ替わっていることはない。
'''

rs.seq_mem_limit(0xffff)

adpcm_data = []
for i in range(256):
    adpcm_data.append(i & 0xf7 | 0x80)

rs.seq_mem_fill_pat(0, int(256/32) - 1, adpcm_data, 256, "ADPCM DATA")

rs.seq_play(0, int(256/32) - 1, int(512), 0, True, "PLAY")

for i in range(64):
    rs.inp(0x08).stat().nl()

rs.seq_stop("STOP")

'''
O00:01 O00:00 
O0C:FF O0D:FF 
ADPCM DATA
O10:00 O10:80 O00:60 O01:02 O02:00 O03:00 O04:07 O05:00 

00000 O08:80 O08:81 O08:82 O08:83 O08:84 O08:85 O08:86 O08:87 O08:80 O08:81 O08:82 O08:83 O08:84 O08:85 O08:86 O08:87 
00010 O08:90 O08:91 O08:92 O08:93 O08:94 O08:95 O08:96 O08:97 O08:90 O08:91 O08:92 O08:93 O08:94 O08:95 O08:96 O08:97 
00020 O08:A0 O08:A1 O08:A2 O08:A3 O08:A4 O08:A5 O08:A6 O08:A7 O08:A0 O08:A1 O08:A2 O08:A3 O08:A4 O08:A5 O08:A6 O08:A7 
00030 O08:B0 O08:B1 O08:B2 O08:B3 O08:B4 O08:B5 O08:B6 O08:B7 O08:B0 O08:B1 O08:B2 O08:B3 O08:B4 O08:B5 O08:B6 O08:B7 
00040 O08:C0 O08:C1 O08:C2 O08:C3 O08:C4 O08:C5 O08:C6 O08:C7 O08:C0 O08:C1 O08:C2 O08:C3 O08:C4 O08:C5 O08:C6 O08:C7 
00050 O08:D0 O08:D1 O08:D2 O08:D3 O08:D4 O08:D5 O08:D6 O08:D7 O08:D0 O08:D1 O08:D2 O08:D3 O08:D4 O08:D5 O08:D6 O08:D7 
00060 O08:E0 O08:E1 O08:E2 O08:E3 O08:E4 O08:E5 O08:E6 O08:E7 O08:E0 O08:E1 O08:E2 O08:E3 O08:E4 O08:E5 O08:E6 O08:E7 
00070 O08:F0 O08:F1 O08:F2 O08:F3 O08:F4 O08:F5 O08:F6 O08:F7 O08:F0 O08:F1 O08:F2 O08:F3 O08:F4 O08:F5 O08:F6 O08:F7 
00080 O08:80 O08:81 O08:82 O08:83 O08:84 O08:85 O08:86 O08:87 O08:80 O08:81 O08:82 O08:83 O08:84 O08:85 O08:86 O08:87 
00090 O08:90 O08:91 O08:92 O08:93 O08:94 O08:95 O08:96 O08:97 O08:90 O08:91 O08:92 O08:93 O08:94 O08:95 O08:96 O08:97 
000a0 O08:A0 O08:A1 O08:A2 O08:A3 O08:A4 O08:A5 O08:A6 O08:A7 O08:A0 O08:A1 O08:A2 O08:A3 O08:A4 O08:A5 O08:A6 O08:A7 
000b0 O08:B0 O08:B1 O08:B2 O08:B3 O08:B4 O08:B5 O08:B6 O08:B7 O08:B0 O08:B1 O08:B2 O08:B3 O08:B4 O08:B5 O08:B6 O08:B7 
000c0 O08:C0 O08:C1 O08:C2 O08:C3 O08:C4 O08:C5 O08:C6 O08:C7 O08:C0 O08:C1 O08:C2 O08:C3 O08:C4 O08:C5 O08:C6 O08:C7 
000d0 O08:D0 O08:D1 O08:D2 O08:D3 O08:D4 O08:D5 O08:D6 O08:D7 O08:D0 O08:D1 O08:D2 O08:D3 O08:D4 O08:D5 O08:D6 O08:D7 
000e0 O08:E0 O08:E1 O08:E2 O08:E3 O08:E4 O08:E5 O08:E6 O08:E7 O08:E0 O08:E1 O08:E2 O08:E3 O08:E4 O08:E5 O08:E6 O08:E7 
000f0 O08:F0 O08:F1 O08:F2 O08:F3 O08:F4 O08:F5 O08:F6 O08:F7 O08:F0 O08:F1 O08:F2 O08:F3 O08:F4 O08:F5 O08:F6 O08:F7 O00:00 O10:80 

PLAY
O10:00 O10:80 O00:20 O01:C2 O02:00 O03:00 O04:07 O05:00 O09:00 O0A:02 O0B:00 O00:B0 
I08:93 S28    
I08:B5 S28    
I08:E0 S68    
I08:82 S28    
I08:A5 S28    
I08:C0 S68    
I08:E3 S68    
I08:87 S2C    
I08:B1 S2C    
I08:D4 S6C    
I08:F6 S6C    
I08:91 S2C    
I08:B4 S2C    
I08:D7 S6C    
I08:82 S2C    
I08:A5 S2C    
I08:C0 S6C    
I08:E2 S6C    
I08:85 S2C    
I08:B0 S2C    
I08:D2 S6C    
I08:F5 S6C    
I08:91 S2C    
I08:B4 S2C    
I08:D6 S6C    
I08:81 S2C    
I08:A4 S2C    
I08:C6 S6C    
I08:E1 S6C    
I08:85 S2C    
I08:B0 S2C    
I08:D2 S6C    
I08:F5 S6C    
I08:90 S2C    
I08:B2 S2C    
I08:D5 S6C    
I08:81 S2C    
I08:A4 S2C    
I08:C6 S6C    
I08:E1 S6C    
I08:84 S2C    
I08:A6 S2C    
I08:D1 S6C    
I08:F3 S6C    
I08:90 S2C    
I08:B2 S2C    
I08:D5 S6C    
I08:F7 S6C    
I08:A2 S2C    
I08:C5 S6C    
I08:E7 S6C    
I08:84 S2C    
I08:A6 S2C    
I08:D1 S6C    
I08:F3 S6C    
I08:96 S2C    
I08:B1 S2C    
I08:D3 S6C    
I08:F6 S6C    
I08:A2 S2C    
I08:C5 S6C    
I08:E7 S6C    
I08:82 S2C    
I08:A5 S2C    

STOP
O00:A1 O00:00 O10:80 
'''
